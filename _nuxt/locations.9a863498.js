import{_ as k}from"./LogoInverted.5939c69c.js";import{_ as C}from"./nuxt-link.891a4dd6.js";import{s as b}from"./globalErrorHandling.ddcb321a.js";import{c as r,d as y}from"./WindTurbineGeneratorStore.eb0d735d.js";import{i as p}from"./chartUtils.2ab73b6e.js";import{_ as L,o as c,c as u,a as o,n as m,v as _,b as f,w as N,x as M,u as S,F as v,s as D}from"./entry.03847b27.js";import{_ as V}from"./LocationCard.d3723006.js";import{_ as A}from"./SubmitButton.e22d1f2f.js";import"./WeatherdataStore.c8d5cae7.js";const T={name:"CreateLocationModal",data(){return{location:{name:"",latitude:0,longitude:0,limit:""}}},methods:{handleCancelClick(){this.$emit("hideModal")},async handleSaveClick(){await this.validateLocation(this.location)},async isADupe(e){const t=await r().getAll();var i=!1;for(let s=0;s<t.length;s++)if(t[s].name===e.name){i=!0;break}return i},async validateLocation(e){if(await this.isADupe(e))b("Name already taken, please select a different one.");else if(!p(e.longitude)||!p(e.latitude)||!p(e.limit)||!p(e.wtg))b("Please make sure all attributes except name are numerical.");else if(e.name===""||e.longitude===null||e.latitude===null||e.limit===null||e.wtg===null)b("Please make sure all fields are filled in.");else{await r().post(e);const i=this.decimalToCoordinates(e.longitude,e.latitude);this.callRetrieve(i.North,i.West,i.South,i.East,e.name),this.$emit("hideModal")}},async callRetrieve(e,t,i,s,n){try{const a=e,l=t,g=i,w=s,x=n,h=new Date().getFullYear();for(let d=h;d>h-20;d=d-2){console.log("asdasd");const te=await y.get(`http://127.0.0.1:5555/data/${a}/${l}/${g}/${w}/${x}/${d}`)}}catch(a){console.error("Error calling retrieve:",a)}},decimalToCoordinates(e,t){let i,s,n,a;return i=Number(t)+.75,n=Number(t)-.75,s=Number(e)-.75,a=Number(e)+.75,{North:i,South:n,East:a,West:s}}}},B={class:"modal rounded-lg flex-col"},E=o("h3",{class:"font-semibold box-title"},"Location Creation",-1),U={class:"py-5 flex flex-col flex-wrap content-center"},P={class:"create-input"},F=o("label",{for:"name"},"Name: ",-1),W={class:"create-input"},H=o("label",{for:"latitude"},"Latitude: ",-1),I={class:"create-input"},R=o("label",{for:"longitude"},"Longitude: ",-1),$={class:"create-input"},j=o("label",{for:"limit"},"Limit: ",-1),G={class:"create-input"},Y=o("label",{for:"wtg"},"WTG: ",-1),q={class:"flex w-full justify-end"};function z(e,t,i,s,n,a){return c(),u("div",{class:"overlay",onClick:t[7]||(t[7]=(...l)=>e.hideModal&&e.hideModal(...l))},[o("div",B,[E,o("div",U,[o("div",P,[F,m(o("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>n.location.name=l),class:"border-2 rounded-md text-center"},null,512),[[_,n.location.name]])]),o("div",W,[H,m(o("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=l=>n.location.latitude=l),class:"border-2 rounded-md text-center"},null,512),[[_,n.location.latitude]])]),o("div",I,[R,m(o("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=l=>n.location.longitude=l),class:"border-2 rounded-md text-center"},null,512),[[_,n.location.longitude]])]),o("div",$,[j,m(o("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=l=>n.location.limit=l),class:"border-2 rounded-md text-center"},null,512),[[_,n.location.limit]])]),o("div",G,[Y,m(o("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=l=>n.location.wtg=l),class:"border-2 rounded-md text-center"},null,512),[[_,n.location.wtg]])])]),o("div",q,[o("button",{type:"submit",class:"border-2 rounded-md px-2",onClick:t[5]||(t[5]=(...l)=>a.handleCancelClick&&a.handleCancelClick(...l))}," Cancel "),o("button",{type:"submit",class:"rounded-md px-2 ml-2 dialog-button",onClick:t[6]||(t[6]=(...l)=>a.handleSaveClick&&a.handleSaveClick(...l))}," Save ")])])])}const J=L(T,[["render",z]]),K={name:"LocationList",data(){return{locations:[],isModalVisible:!1,loading:!0,downloaded:!1}},async mounted(){this.locations=await r().getAll(),this.locations.length==0||(this.loading=!1)},async updated(){this.locations=await r().getAll(),this.locations.length==0||(this.loading=!1)},methods:{showModal(){this.isModalVisible=!0},hideModal(){this.isModalVisible=!1},sendDownloadedNotification(){this.downloaded=!0},handleLocationSelected(e){r().setSelectedLocation(e)},handleLocationDeselected(){r().setSelectedLocation(null)},navigateToNextPage(){r().getSelectedLocation()!==null&&this.$router.push("/wtgs")}}},O=o("div",{class:"heading-container"},[o("h1",{class:"generic-header"},"Locations")],-1),Q={"deck-frame-translucent-container":""},X={key:0,class:"grid deck-frame-translucent"},Z={key:1};function ee(e,t,i,s,n,a){const l=k,g=C,w=J,x=V,h=A;return c(),u(v,null,[f(g,{to:"/"},{default:N(()=>[f(l,{class:"inline-block align-middle w-full"})]),_:1}),O,n.isModalVisible?(c(),M(w,{key:0,onHideModal:a.hideModal,onDownloaded:a.sendDownloadedNotification},null,8,["onHideModal","onDownloaded"])):S("",!0),o("div",Q,[n.loading?(c(),u("div",Z," Loading data... ")):(c(),u("div",X,[(c(!0),u(v,null,D(n.locations,d=>(c(),u("div",{key:d._id},[f(x,{location:d,downloaded:n.downloaded,onLocationSelected:a.handleLocationSelected,onLocationDeselected:a.handleLocationDeselected},null,8,["location","downloaded","onLocationSelected","onLocationDeselected"])]))),128)),f(h,{onClick:a.navigateToNextPage},null,8,["onClick"])]))])],64)}const ue=L(K,[["render",ee]]);export{ue as default};
